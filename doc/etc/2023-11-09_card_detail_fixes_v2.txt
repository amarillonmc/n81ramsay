# 2023-11-09 卡片详情修复（第二版）

## 问题描述
卡片详情页面中存在以下问题：
1. 类别显示为"未知类别"（括号中解析的十六进制数是正确的）
2. 种族显示为"未知种族"（括号中解析的十六进制数是正确的）
3. 属性显示为"未知属性"（括号中解析的十六进制数是正确的）

## 修复内容

### 1. 改进卡片信息映射加载
修改了 `loadCardInfoMappings()` 方法，使其能够更好地处理文件格式：
- 使用 `preg_split('/[\t\s]+/', $line, 2)` 替代 `explode("\t", $line)` 来处理可能的空格和制表符混合情况
- 添加了更详细的日志记录，以便于调试
- 在加载完成后打印所有加载的类型、种族和属性信息，以便于验证

### 2. 简化类型文本解析
修改了 `getTypeText()` 方法，使其更简洁和可靠：
- 移除了过多的调试日志，保留必要的信息
- 保持了按位检查类型的逻辑，确保复合类型能够正确显示

### 3. 简化种族文本解析
修改了 `getRaceText()` 方法，使其更简洁：
- 移除了过多的调试日志
- 保持了直接比较十进制值的逻辑，确保种族能够正确显示

### 4. 简化属性文本解析
修改了 `getAttributeText()` 方法，使其更简洁：
- 移除了过多的调试日志
- 保持了直接比较十进制值的逻辑，确保属性能够正确显示

## 技术说明
- 问题的根本原因可能是文件格式问题，cardinfo_chinese.txt 文件中使用了制表符分隔，但可能在某些行中混合了空格
- 通过使用更灵活的分隔符解析方法，我们能够正确加载所有的类型、种族和属性信息
- 卡片类别（type）是一个位掩码，可能包含多个类型值的组合，需要按位检查
- 种族（race）和属性（attribute）是单一值，直接对应一个十六进制代码
