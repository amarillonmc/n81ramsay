# 2023-12-05 15:00 - 作者榜单禁卡表优化

按照用户需求，优化了作者榜单中涉及到禁卡表读取的逻辑，排除掉 #Forbidden TCG 抬头下的内容，因为这些禁卡并非属于服务器中作者的卡片。

## 主要变更

1. 修改了 `AuthorStats` 模型中的 `getStandardBanlist()` 方法，排除 TCG 禁卡。

2. 添加了新方法 `getTCGBanlist()`，用于从 lflist.conf 文件中读取 TCG 禁卡列表。

## 技术细节

1. `getStandardBanlist()` 方法现在会：
   - 获取标准环境的禁卡列表
   - 获取 TCG 禁卡列表
   - 从标准环境禁卡列表中移除 TCG 禁卡
   - 返回过滤后的禁卡列表

2. 新增的 `getTCGBanlist()` 方法会：
   - 读取 lflist.conf 文件
   - 识别 #Forbidden TCG 部分
   - 解析该部分中的卡片 ID 和禁限状态
   - 返回 TCG 禁卡列表

## 影响

这个更改确保了作者榜单中的禁卡统计更加准确，只考虑服务器中作者的卡片，而不包括 TCG 禁卡。具体影响包括：

1. 作者榜单中的"标准环境被禁卡数量"和"标准环境被禁卡百分比"将更准确地反映服务器中作者的卡片禁限情况。

2. 作者榜单中的"标准环境系列禁止数量"也将更准确，不再受 TCG 禁卡的影响。

3. 这将使作者榜单更公平，避免因 TCG 禁卡而导致的统计偏差。

## 实现细节

在实现过程中，我们通过解析 lflist.conf 文件来识别 TCG 禁卡。具体步骤如下：

1. 读取 lflist.conf 文件内容
2. 按行解析文件
3. 识别 #Forbidden TCG 部分的开始
4. 解析该部分中的卡片信息，直到遇到新的环境标题或其他主要部分
5. 将解析得到的 TCG 禁卡列表用于过滤标准环境禁卡列表
