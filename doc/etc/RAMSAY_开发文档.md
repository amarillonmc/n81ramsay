# RAMSAY 开发文档

## 目录

1. [系统概述](#系统概述)
2. [功能模块](#功能模块)
   - [卡片检索](#卡片检索)
   - [投票禁卡](#投票禁卡)
   - [禁卡表管理](#禁卡表管理)
   - [作者光荣榜](#作者光荣榜)
3. [技术实现](#技术实现)
4. [更新日志](#更新日志)
   - [2023年11月](#2023年11月)
   - [2024年7月](#2024年7月)

## 系统概述

RAMSAY是一个专为no81游戏王DIY服务器设计的管理系统，旨在自动化和简化服务器的各种运营事务。该系统提供卡片检索、投票禁卡、禁卡表整理、作者光荣榜等功能，帮助服务器管理员和玩家更高效地管理游戏环境。

## 功能模块

### 卡片检索

- 支持按卡片ID或卡名搜索
- 显示卡片详细信息和卡图
- 查看卡片在各环境中的禁限状态
- 支持分页显示，提高大量卡片的浏览效率

### 投票禁卡

- 用户可以发起对特定卡片的禁限投票
- 生成唯一投票链接供其他玩家参与
- 支持多种禁限状态（禁止、限制、准限制、无限制）
- 同一IP只能投一次票
- 显示所有有效投票链接
- 展示投票周期、卡片信息和当前投票状态

### 禁卡表管理

- 管理员可以查看和管理所有投票
- 统计投票结果，生成禁卡表文本
- 支持生成lflist.conf格式的禁卡表
- 重置投票并推进投票周期

### 作者光荣榜

- 展示所有卡片作者的统计数据
- 按投稿卡片数量从高到低排序
- 显示每位作者的禁卡比例和被禁系列数量
- 高亮显示禁卡比例较高的作者
- 自动识别卡片作者，支持多种作者信息格式

## 技术实现

- 基于PHP开发，无需额外框架
- 使用SQLite数据库存储卡片和投票数据
- 响应式设计，适配各种设备
- 支持在IIS服务器上部署
- 环境要求：PHP 7.0+, SQLite 3

## 更新日志

### 2023年11月

#### 2023-11-09 卡片功能和修复

- 实现了卡片详情页面，显示卡片的完整信息
- 修复了卡片类型、种族和属性的显示问题
- 添加了卡片图片显示功能，支持从服务器获取卡图
- 优化了卡片搜索功能，支持按ID和名称搜索

#### 2023-11-09 卡片分页功能

- 实现了卡片列表的分页功能
- 支持自定义每页显示的卡片数量（10/20/50/100）
- 添加了分页导航，方便用户浏览大量卡片

#### 2023-11-15 系统修复

- 修复了多个页面布局问题
- 优化了移动设备上的显示效果
- 修复了字符串比较函数的使用问题
- 改进了错误处理和日志记录

#### 2023-11-22 系统初始化

- 创建了基本的目录结构
- 实现了MVC架构
- 生成了初始代码和视图模板
- 配置了系统环境和参数

#### 2023-11-23 布局优化

- 优化了整体页面布局
- 改进了导航栏和页脚设计
- 更新了README文档

### 2024年7月

#### 2024-07-09 禁卡表管理实现

- 实现了禁卡表管理功能
- 添加了投票结果统计和分析
- 支持生成lflist.conf格式的禁卡表
- 添加了管理员界面，方便管理禁卡表

#### 2024-07-10 作者光荣榜功能

- 实现了作者光荣榜功能
- 显示所有作者的卡片数量和禁卡比例
- 按禁卡比例排序，高亮显示禁卡比例高的作者
- 统计每位作者的被禁系列数量

#### 2024-07-11 作者名称规范化

- 实现了作者名称规范化功能
- 处理各种格式的作者信息
- 移除常见的附加文本（如"图侵删歉"）
- 优化了英文作者名的处理逻辑

#### 2024-07-12 空作者名修复

- 修复了作者名为空的问题
- 确保作者名称规范化函数不会返回空字符串
- 增强了作者提取逻辑
- 优化了作者光荣榜的显示效果

#### 2024-07-13 作者检测逻辑优化

- 移除了从卡名中提取作者信息的逻辑
- 增强了从strings.conf文件中解析作者信息的能力
- 改进了卡片ID与作者匹配的逻辑
- 增加了使用卡片ID前三位进行匹配的功能

#### 2024-07-13 作者光荣榜改进

- 处理空作者名问题，使用卡片ID前三位作为替代
- 修改排序逻辑，优先按投稿卡片数量从高到低排序
- 将未知作者和ID前缀作者放在已知作者之后显示
- 统一视图中的样式处理逻辑
