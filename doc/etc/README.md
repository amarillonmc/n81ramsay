# RAMSAY 开发文档

## 目录

1. [系统概述](#系统概述)
2. [功能模块](#功能模块)
3. [技术实现](#技术实现)
4. [文档索引](#文档索引)
5. [部署说明](#部署说明)
6. [配置说明](#配置说明)

## 系统概述

RAMSAY是一个专为no81游戏王DIY服务器设计的管理系统，旨在自动化和简化服务器的各种运营事务。该系统提供卡片检索、投票禁卡、禁卡表整理、作者光荣榜等功能，帮助服务器管理员和玩家更高效地管理游戏环境。

## 功能模块

### 卡片检索

- 支持按卡片ID或卡名搜索
- 显示卡片详细信息和卡图
- 查看卡片在各环境中的禁限状态
- 支持分页显示，提高大量卡片的浏览效率

### 投票禁卡

- 用户可以发起对特定卡片的禁限投票
- 生成唯一投票链接供其他玩家参与
- 支持多种禁限状态（禁止、限制、准限制、无限制）
- 同一IP只能投一次票
- 显示所有有效投票链接
- 展示投票周期、卡片信息和当前投票状态

### 禁卡表管理

- 管理员可以查看和管理所有投票
- 统计投票结果，生成禁卡表文本
- 支持生成lflist.conf格式的禁卡表
- 重置投票并推进投票周期

### 作者光荣榜

- 展示所有卡片作者的统计数据
- 按投稿卡片数量从高到低排序
- 显示每位作者的禁卡比例和被禁系列数量
- 高亮显示禁卡比例较高的作者
- 自动识别卡片作者，支持多种作者信息格式

## 技术实现

- 基于PHP开发，无需额外框架
- 使用SQLite数据库存储卡片和投票数据
- 响应式设计，适配各种设备
- 支持在IIS服务器上部署
- 环境要求：PHP 7.0+, SQLite 3

## 文档索引

系统的详细文档按功能模块和开发阶段进行了组织，以下是文档索引：

### 最新更新

1. [系统更新汇总 (2024-06-27)](20240627_consolidated_updates.md)
   - 卡片别名(alias)字段优化
   - TCG卡片系列(setcode)识别优化
   - 投票结果处理优化

2. [界面优化更新 (2024-06-24)](20240624_consolidated_ui_updates.md)
   - 修复管理员投票管理界面的显示问题
   - 已关闭投票卡图灰度显示优化
   - 投票界面优化
   - 投票概览页面优化
   - 投票者唯一标识功能

3. [作者光荣榜功能更新 (2024-06-26)](20240626_author_hall_of_fame_updates.md)
   - 作者光荣榜缓存功能
   - 作者光荣榜详情页面增强

4. [卡片排行榜功能更新 (2024-06-24)](20240624_card_ranking_updates.md)
   - "只看DIY卡排名"功能实现
   - 修复TCG卡片检测逻辑

5. [其他系统更新 (2024-06-25-27)](20240625_additional_updates.md)
   - 添加投票管理按钮
   - 临时文件处理修复

### 功能模块文档

1. [卡片功能与修复](card_features.md)
   - 卡片详情显示
   - 卡片分页功能
   - 卡片图片显示
   - 卡片数据库配置

2. [作者管理功能与修复](author_management.md)
   - 作者信息解析
   - 作者管理功能
   - 作者编辑功能
   - 作者前缀编辑功能
   - 作者光荣榜
   - 作者识别修复

3. [系统修复记录](system_fixes.md)
   - 路由处理修复
   - 环境配置修复
   - 部署配置修复
   - 调试功能修复
   - PHP兼容性修复

4. [布局与界面修复](layout_fixes.md)
   - 页面布局修复
   - 导航菜单优化
   - 移动设备适配
   - 管理界面优化

5. [开发日志](development_log.md)
   - 按时间顺序记录的开发进度和修复内容

## 部署说明

### 服务器要求

- Web服务器：IIS 7.0+
- PHP版本：7.0+
- SQLite版本：3.0+
- 磁盘空间：根据卡片数据库大小，建议至少500MB

### 部署步骤

1. 将程序文件上传到服务器
2. 确保根目录是index.php所在的位置，不使用public/目录进行前后端分离
3. 配置IIS，将默认文档设置为index.php
4. 确保PHP有足够的权限读写SQLite数据库文件
5. 修改config.php中的配置项，适应当前环境
6. 访问网站首页，检查系统是否正常运行

## 配置说明

系统的主要配置项位于config.php文件中，以下是关键配置项的说明：

### 基本配置

- `DEBUG_MODE`：调试模式开关，true为开发环境，false为生产环境
- `BASE_URL`：网站基础URL，用于生成链接
- `SITE_TITLE`：网站标题，显示在浏览器标签和页面顶部

### 卡片数据配置

- `CARD_DATA_PATH`：卡片数据库目录路径
- `DB_STRINGS_PATH`：卡片字符串定义文件路径
- `EXCLUDED_CDB_FILES`：要排除的卡片数据库文件列表，默认为`['Pre_Nerf_cards.cdb', 'SoundStageLib.cdb']`

### 作者识别配置

- `SIMPLE_AUTHOR_MODE`：简化作者识别模式开关，true时只使用管理员管理的作者列表，默认为false

### 用户界面配置

- `DEFAULT_PAGE_SIZE`：卡片列表默认每页显示数量，默认为20
- `PAGE_SIZE_OPTIONS`：可选的每页显示数量选项，默认为`[10, 20, 50, 100]`

### 管理员配置

- `ADMIN_USERNAME`：管理员用户名
- `ADMIN_PASSWORD`：管理员密码的哈希值
- `ADMIN_LEVEL`：管理员权限等级，1为普通管理员，2为高级管理员
