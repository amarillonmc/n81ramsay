# 2023-11-09 卡片详情修复（第三版）

## 问题描述
卡片详情页面中存在以下问题：
1. 类别显示为"未知类别"（括号中解析的十六进制数是正确的）
2. 种族显示为"未知种族"（括号中解析的十六进制数是正确的）
3. 属性显示为"未知属性"（括号中解析的十六进制数是正确的）
4. 调试信息使用了不适合IIS环境的error_log()方法

## 修复内容

### 1. 添加适合IIS环境的调试工具
在Utils类中添加了debug()方法，用于替代error_log()：
- 将调试信息写入到logs/debug.log文件中
- 只在DEBUG_MODE开启时记录日志
- 支持记录复杂数据结构
- 自动创建日志目录（如果不存在）

### 2. 改进卡片信息映射加载
修改了loadCardInfoMappings()方法，使用新的调试工具：
- 使用Utils::debug()替代error_log()
- 保持使用preg_split()来处理混合的空格和制表符
- 更结构化地记录调试信息

### 3. 改进类型文本解析
修改了getTypeText()方法，使用新的调试工具：
- 使用Utils::debug()替代error_log()
- 更详细地记录类型匹配过程
- 保持按位检查类型的逻辑

## 技术说明
- 新的调试方法更适合IIS环境，可以在服务器上创建可访问的日志文件
- 调试信息只在DEBUG_MODE开启时记录，不影响生产环境性能
- 日志文件位于项目根目录的logs/目录下，便于管理和查看
- 调试信息包含时间戳，便于追踪问题发生的时间
