卡片排行榜功能修复记录 - 2024-07-10

1. 修复问题：
   - 修复了 CardRanking 构造函数错误：在 CardRankingController 中调用 CardRanking 模型类时出现的私有构造函数错误
   - 修复了 TCG 卡片作者显示问题：为 TCG 卡片显示"TCG/OCG卡片"作为作者信息
   - 增强了 CardParser 类对 TCG 卡片数据库的支持

2. 修改文件：
   - includes/Models/CardRanking.php：确保正确加载核心类
   - includes/Controllers/CardRankingController.php：确保 DeckParser 类已加载
   - includes/Views/cards/detail.php：修改作者显示逻辑，为 TCG 卡片显示特定信息
   - includes/Core/CardParser.php：增强对 TCG 卡片数据库的支持

3. 修复详情：

   a. CardRanking 模型类修复：
      - 添加了对核心类的显式加载：`require_once __DIR__ . '/../Core/CardRanking.php'`
      - 修改了类型提示，明确指定命名空间：`@var \CardRanking`

   b. CardRankingController 控制器修复：
      - 添加了对 DeckParser 类的显式加载：`require_once __DIR__ . '/../Core/DeckParser.php'`
      - 确保在创建 CardRanking 模型实例前加载所有依赖

   c. 卡片详情页面修复：
      - 修改了作者显示逻辑，根据卡片类型显示不同的作者信息
      - 为 TCG 卡片显示"TCG/OCG卡片"作为作者信息
      - 为未知作者的卡片显示"未知"作为作者信息

   d. CardParser 类修复：
      - 增强了 getCardById 方法，支持从 TCG 卡片数据库中查找卡片
      - 为 TCG 卡片设置空作者信息，以便在详情页面中显示"TCG/OCG卡片"

4. 注意事项：
   - 确保 TCG_CARD_DATA_PATH 配置项正确指向 TCG 卡片数据库文件
   - 确保 ALLOW_TCG_CARD_VOTING 配置项正确设置，控制是否允许对 TCG 卡片发起禁卡投票
   - 卡片排行榜功能默认是关闭的，需要在配置文件中将 CARD_RANKING_ENABLED 设置为 true 才能启用
